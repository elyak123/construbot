{% extends "base.html" %}
{% load i18n %}
{% load humanize %}
{% block title %} Detalle de {{ contrato.contrato_shortName }} {% endblock %}

{% block content %}
{% language 'es' %}
<h2 class="title" > Detalle del contrato {{ contrato.contrato_name }}</h2>
<div id="dato" data-id="{{ contrato.id }}"></div>
<div class="cont_table_sample">
	<table class="table_sample table_detalle">
		<tr>
			<th colspan="2" class="th_table_sample">{{ contrato.folio }}. {{ contrato.contrato_name }}</th>
		</tr>
		<tr>
			<td class="td_table_sample">Código de contrato</td>
			<td class="td_table_sample">{{ contrato.code }}</td>
		</tr>
		<tr>
			<td class="td_table_sample">Nombre corto</td>
			<td class="td_table_sample">{{ contrato.contrato_shortName }}</td>
		</tr>
		<tr>
			<td class="td_table_sample">Cliente</td>
			<td class="td_table_sample">{{ contrato.cliente.cliente_name }}</td>
		</tr>
		<tr>
			<td class="td_table_sample">Sitio</td>
			<td class="td_table_sample">{{ contrato.sitio.sitio_name }}</td>
		</tr>
		<tr>
			<td class="td_table_sample">Monto sin IVA</td>
			<td class="td_table_sample">$ {% language 'en' %}{{ contrato.monto|intcomma }}{% endlanguage %}</td>
		</tr>
		<tr>
			<td class="td_table_sample">Fecha de Firma</td>
			<td class="td_table_sample">{{ contrato.fecha|date:"d/F/Y" }}</td>
		</tr>
		<tr>
			<td class="td_table_sample">¿Terminado?</td>
			<td class="td_table_sample"><strong>{% if status %}Sí{% else %}No{% endif %}</strong></td>
		</tr>
	</table>
</div>
<br>
<div class="cont_listado"><strong>Catálogo de conceptos </strong><a href="{% url 'construbot.proyectos:catalogo_conceptos' contrato.id %}"><span class="oi oi-pencil"></span></a><span class="oi oi-chevron-left icon_right"></span><span class="oi oi-chevron-top icon_right-up"></span></div>
<div class="cont_result" id="cont_result_concept">
	<table class="table_results">
		<tr>
			<th> Código </th>
			<th> Concepto </th>
			<th> Unidad </th>
			<th> Cantidad </th>
			<th> Precio unitario </th>
		</tr>
	</table>
	<div class="cont_message_no_result">¡No existe catálogo de concepto!, crear <a href="{% url 'construbot.proyectos:catalogo_conceptos' contrato.id %}"><strong>aquí</strong></a>.</div>
</div>
{% if contrato.estimate_set.all %}
	<h2 class="title"> Listado de estimaciones de {{ contrato.contrato_shortName }}</h2>
	<table class="table_sample table_normal">
		<tr>
			<th class="th_table_sample"> No. </th>
			<th class="th_table_sample"> Nombre </th>
			<th class="th_table_sample"> Monto </th>
			<th class="th_table_sample"> F. de Pago </th>
			<th class="th_table_sample"> Editar </th>
		</tr>
	{% for estimacion in contrato.estimate_set.all %}
		<tr>
			<td class="td_table_sample">{{ estimacion.consecutive }}</td>
			<td class="td_table_sample">Estimación {{ estimacion.consecutive }}</td>
			<td class="td_table_sample">{% language 'en' %}$ {{ estimacion.total_estimate.total|intcomma }}{% endlanguage %}</td>
			<td class="td_table_sample">{{ estimacion.payment_date|date:"d/F/Y" }}</td>
			<td class="td_table_sample">
				<a href="{% url 'proyectos:editar_estimacion' estimacion.pk %}">Editar</a> /
				<a href="">Eliminar</a>
			</td>
		</tr>
	{% endfor %}
	</table>
{% else %}
	<h3> No existen estimaciones para este contrato aún. <a href="">Crea una aquí</a>.</h3>
{% endif %}
{% endlanguage %}
{% endblock %}

{# CÓDIGO, DESCRIPCIÓN, CONCEPTO, UNIDAD, CANTIDAD, PRECIO UNITARIO #}
